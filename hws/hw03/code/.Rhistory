ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_point()
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
library(ggplot2)
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()
dev.off()
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_point() + geom_label(aes(label=val$team))
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
library(ggplot2)
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()
dev.off()
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_point() + geom_text(aes(label=val$team))
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
library(ggplot2)
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()
dev.off()
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
library(ggplot2)
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()
dev.off()
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip()
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="First PC(scaled from 0 to 100)", y="Team", title="NBA Teams Ranked by scaled PC1") + coord_flip()
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
library(ggplot2)
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()
dev.off()
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
teams <- read.csv("../data/nba2017-teams.csv")
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
teams <- read.csv("../data/nba2017-teams.csv")
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6), cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
teams <- read.csv("../data/nba2017-teams.csv")
#Teams Ranked By Salary
ggplot(teams, aes(x=reorder(team, salary), y=salary)) + geom_bar(stat="identity") + labs(x="Teams", y="Salary(In Millions)", title="NBA Teams Ranked by Total Salary") + coord_flip() + geom_hline(yintercept = mean(teams$salary), colour="red")
#Teams Ranked By Points
ggplot(teams, aes(x=reorder(team, points), y=points)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Points", title="NBA Teams Ranked by Total Points") + coord_flip() + geom_hline(yintercept = mean(teams$points), colour="red")
#Teams Ranked By Efficiency
ggplot(teams, aes(x=reorder(team, efficiency), y=efficiency)) + geom_bar(stat="identity") + labs(x="Teams", y="Total Efficiency", title="NBA Teams Ranked by Total Efficiency") + coord_flip() + geom_hline(yintercept = mean(teams$efficiency), colour="red")
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6))
eigs<- mutate(eigs, cumprop= cumsum(eigs$prop))
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
summary(teams)
summary(teams)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
temp <- summary(teams)
temp
View(temp)
summary(teams)
sink(file= "../data/teams-summary.txt")
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
library(dplyr)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
summary(teams)
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team))
-------
title: "Data Preparation"
library(ggplot2)
library(dplyr)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../output/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team))
dev.off()
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../output/teams-summary.txt")
summary(teams)
-------
title: "Data Preparation"
description: "A file used to store all of the data preparation code."
input(s):"nba2017-roster.csv, nba2017-stats.csv"
outputs(s):"efficiency-summary.txt, teams, teams_star_plot.pdf, experience_salary.pdf"
-------
library(ggplot2)
library(dplyr)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../output/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team))
dev.off()
val <- data.frame(team=teams$team, PCA$x)
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6))
eigs<- mutate(eigs, cumprop= cumsum(eigs$prop))
eigs
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) + geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
#Principal Component Analysis
PCA <- prcomp(select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls), scale.=TRUE)
eigs <- data.frame(eigenvalue=(PCA$sdev)^2, prop= round((PCA$sdev^2)/sum(PCA$sdev^2), 6))
eigs<- mutate(eigs, cumprop= cumsum(eigs$prop))
eigs
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) +geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
#PC Interpretation
val$rotation
View(teams)
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) +geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
#PC Interpretation
weights <- val$rotation
weights
View(val)
val <- data.frame(team=teams$team, PCA$x)
ggplot(val, aes(x=PC1, y=PC2)) +geom_text(aes(label=val$team))
s1 <- (100) * ((val$PC1 - min(val$PC1))/(max(val$PC1)-min(val$PC1)))
df2 <- data.frame(team=val$team, s1)
ggplot(df2, aes(x=reorder(team, s1), y=s1)) + geom_bar(stat="identity") + labs(x="Team", y="First PC(scaled from 0 to 100)", title="NBA Teams Ranked by scaled PC1") + coord_flip()
#PC Interpretation
weights<- PCA$rotation
weights
View(weights)
?ggtitle
??ggtitle
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team)) + ggtitle(label="Scatterplot of Experience vs.Salary")
library(ggplot2)
library(dplyr)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../output/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team)) + ggtitle(label="Scatterplot of Experience vs.Salary")
dev.off()
library(ggplot2)
library(dplyr)
dat_roster <- read.csv("../data/nba2017-roster.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- read.csv("../data/nba2017-stats.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
dat_stats <- mutate(dat_stats, missed_fg= field_goals_atts - field_goals_made,missed_ft= points1_atts - points1_made,
points= 3*points3_made + 2*points2_made+ points1_made, rebounds= off_rebounds + def_rebounds,
efficiency= (points + rebounds + assists + steals + blocks - missed_fg - missed_ft - turnovers)/games_played)
sink(file= "../output/efficiency-summary.txt")
summary(dat_stats$efficiency)
sink()
dat_merge <- merge(dat_roster, dat_stats)
teams <- dat_merge %>%
group_by(team) %>%
summarise(experience= sum(experience), salary=sum(salary/1000000), points3= sum(points3_made), points2= sum(points2_made), free_throws= sum(points1_made), points= sum(points1_made+ 2*points2_made+ 3*points3_made), off_rebounds= sum(off_rebounds), def_rebounds= sum(def_rebounds), assists= sum(assists), steals= sum(steals), blocks= sum(blocks), turnovers= sum(turnovers), fouls= sum(fouls), efficiency= sum(efficiency))
summary(teams)
sink(file= "../output/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, "../data/nba2017-teams.csv")
pdf("../images/teams_star_plot.pdf")
stars(teams[ ,-1], labels=teams$team)
dev.off()
pdf("../images/experience_salary.pdf")
ggplot(teams, aes(x=experience, y=salary)) + geom_point()+geom_text(aes(label=teams$team)) + ggtitle(label="Scatterplot of Experience vs. Salary")
dev.off()
