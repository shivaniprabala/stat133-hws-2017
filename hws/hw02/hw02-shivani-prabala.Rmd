---
title: "HW 02- Basics of Data Frames"
output: github_document
author: "Shivani Prabala"
date: "October 2nd, 2017"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff= 80),tidy=TRUE)
```


#PART2 
```{r}
#importing use R base functions
github <- "https://github.com/ucb-stat133/stat133-fall-2017/raw/master/"
file <- "data/nba2017-player-statistics.csv"
csv <- paste0(github, file)
data_frame_base <- read.csv(csv, colClasses= c("character", "character", "factor", "character", "double",rep("integer", 19))) 
str(data_frame_base)
```

```{r}
#importing use reader package 
library(readr)
data_frame_readr <- read_csv(csv, col_types= list(col_character(),col_character(), col_factor(c("C", "PF", "PG", "SF", "SG")), col_character(), col_double(),col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer()))
str(data_frame_readr)

```

#PART3 
```{r}
#Data processing on Experience 
data_frame_base$Experience[data_frame_base$Experience=="R"] <- 0 #replacing all values of "R" with 0
data_frame_base$Experience <- as.integer(data_frame_base$Experience) #converting Experience to integer 
class(data_frame_base$Experience)
str(data_frame_base)

```

#PART4 
```{r}
library(dplyr)
#Missed field goals = attempted field goals - successful field goals 
data_frame_base <- mutate(data_frame_base, Missed_FG= data_frame_base$FGA - data_frame_base$FGM)
#Missed free throws = attempted free throws - free throws missed 
data_frame_base <- mutate(data_frame_base, Missed_FT= data_frame_base$FTA- data_frame_base$FTM)
#Points total 
data_frame_base <- mutate(data_frame_base, PTS= (data_frame_base$Points3 * 3) + (data_frame_base$Points2 *2) + data_frame_base$FTM)
# Total REB= offensive rebounds + defesive rebounds 
data_frame_base <- mutate(data_frame_base, REB= data_frame_base$OREB + data_frame_base$DREB)
#Minutes per game = minutes played/ number of games played 
data_frame_base <- mutate(data_frame_base, MPG= data_frame_base$MIN/data_frame_base$GP)
#Adding the EFF column
data_frame_base <- mutate(data_frame_base, EFF= ((data_frame_base$PTS + data_frame_base$REB + data_frame_base$AST + data_frame_base$STL + data_frame_base$BLK - data_frame_base$Missed_FG - data_frame_base$Missed_FT - data_frame_base$TO)/data_frame_base$GP))
#Summary statistics of EFF 
summary(data_frame_base$EFF)
#histogram for EFF 
hist(data_frame_base$EFF, xlab = "EFF", main="History of Efficiency(EFF)", col="grey")

dftop10 <- slice(select(arrange(data_frame_base, desc(EFF)), Player, Team, Salary, EFF), 1:10)
dftop10
data_frame_base$Player[data_frame_base$EFF<0]

#correlations between EFF and all variables used in EFF formula 
#correlation between EFF and Missed_FG
Missed_FG <- -cor(data_frame_base$EFF, data_frame_base$Missed_FG)
Missed_FG
#correlation between EFF and Missed_FT 
Missed_FT <- -cor(data_frame_base$EFF, data_frame_base$Missed_FT)
Missed_FT
#correlation between EFF and PTS 
PTS <- cor(data_frame_base$EFF, data_frame_base$PTS)
PTS
#correlation between EFF and REB
REB <- cor(data_frame_base$EFF, data_frame_base$REB)
REB
#correlation between EFF and AST 
AST <- cor(data_frame_base$EFF, data_frame_base$AST)
AST
#correlation between EFF and STL 
STL <- cor(data_frame_base$EFF, data_frame_base$STL)
STL
#correlation between EFF and BLK 
BLK <- cor(data_frame_base$EFF, data_frame_base$BLK)
BLK
#correlation between EFF and TO 
TO <- -cor(data_frame_base$EFF, data_frame_base$TO)
TO

#Making a data frame and barplot with correlations 
names <- c( "Missed_FG", "Missed_FT", "PTS", "REB", "AST", "STL", "BLK", "TO")
numbers <- c(Missed_FG, Missed_FT, PTS, REB, AST, STL, BLK, TO)
dfcor_dec <- data.frame(names, numbers)
dfcor_dec <- arrange(dfcor_dec, desc(numbers))
barplot(dfcor_dec$numbers, names.arg = dfcor_dec$names, main="Correlations between Player Stats and EFF", ylim=c(-1.0, 1.0), col=c("gray", "gray", "gray", "gray", "gray", "coral", "coral", "coral"), ylab = "EFF")
abline(h=0)

```

#PART5 
```{r}
#Scatterplot between Efficiency and Salary 
plot(data_frame_base$EFF, data_frame_base$Salary, xlab="Efficiency", ylab="Salary", main= "Scatterplot of Efficiency vs. Salary") 
lines(lowess(data_frame_base$EFF, data_frame_base$Salary), col=3, lwd=3)
saleffcorr <- cor(data_frame_base$EFF, data_frame_base$Salary)
saleffcorr
```

######Based on the positive association viewed on the scatterplot and the linear correlation coefficient of `r saleffcorr`, I would say that Efficiency and Salary have a moderate to strong positive relationship to one another. 

```{r}
MPG_morethan20players <- data_frame_base[data_frame_base$MPG>19, ]
players2 <- data.frame(MPG_morethan20players)
plot(players2$EFF, players2$Salary, main= "Efficiency vs Salary for players with 20 or more minutes of Game Time", xlab="Efficiency", ylab="Salary")
lines(lowess(players2$EFF, players2$Salary), col=3, lwd=3)
cor_morethan20 <- cor(players2$EFF, players2$Salary)
cor_morethan20
```

######Based on the positive association viewed on the scatterplot and the linear correlation coefficient of `r cor_morethan20`, I would say that Efficiency and Salary have a moderate positive relationship to one another. This correlation coefficient is less than the coefficient using all player data, which suggests that for more experienced players the positive association between Efficiency and Salary is less strong. This could be for a number of reasons such as loyalty to the team having a higher precedence than efficiency or fan's pressure for a team to keep a certain player. 

#PART6 

* Remembering how to access certain parts of data frames was hard, even though I saw them in class. 
* Figuring out how to use cor() was pretty easy even though we hadn't seen it in class. 
* I needed help from my GSI to fix an error in reading the csv files. I realized that I just needed to use the library function. 
* It took me about 3 hours to complete this assignment. 
* The most time consuming part was figuring out how to read the files use read.csv() and read_csv(). 
* I did not fully understand when to use R base functions to access information inside data frames, versus when to use the dplyr functions. 
* Nothing was particularly frustrating to me. 
* I liked seeing the graphs match up to the solution graphs, and figuring out diffiult parts of the lab myself. 